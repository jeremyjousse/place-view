name: Deploy places

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy:
    name: Deploy website
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout main branch
        uses: actions/checkout@v4
        with:
          path: "sources"
      - name: â›“ï¸â€ğŸ’¥ Checkout site branch
        uses: actions/checkout@v4
        with:
          ref: "gh-pages"
          path: "site"
      - name: ğŸ“¤ Copy places.json
        run: |
          cp "./sources/resources/places.json" "site"
      - name: âœ… Commit changes to deploy
        run: |
          cd site
          git config user.name "GitHub Actions Bot"
          git config user.email "<>"
          git add .
          if [ "$(git status --porcelain | wc -l)" -eq "0" ]; then git commit -m "ğŸ” update places.json" && git push && echo "ğŸš€ places.json pushed to gp-page branch"; fi
